<!-- Only important parts shown -->
<script>
let symbol = "XRPUSDT";
let budget = 10;
let stopPercent = 5;
let takeProfitPercent = 20;

let ws = null;

function startBot() {
    ws = new WebSocket(`wss://stream.binance.com:9443/ws/${symbol.toLowerCase()}@kline_1m`);
    ws.onmessage = async (msg) => {
        const data = JSON.parse(msg.data);
        const k = data.k; // candlestick data
        const open = parseFloat(k.o);
        const close = parseFloat(k.c);
        const high = parseFloat(k.h);
        const low = parseFloat(k.l);

        // Simple candlestick pattern example
        // Bullish: close > open, bearish: close < open
        if (close > open) {
            console.log("Bullish candle detected — consider buying");
            await fetch("/buy", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ symbol, budget })
            });
        } else if (close < open) {
            console.log("Bearish candle detected — consider selling");
            await fetch("/sell", {
                method: "POST",
                headers: { "Content-Type": "application/json" },
                body: JSON.stringify({ symbol })
            });
        }
    };
}

document.getElementById("start").addEventListener("click", startBot);
</script>
